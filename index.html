<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MyTutor.Kz — Online Learning for Kids</title>
  <meta name="description" content="MyTutor.Kz — персональные онлайн-уроки английского для детей. Опытные преподаватели, гибкий график и индивидуальные программы." />
  <style>
    :root{
      --primary:#2e6fb7;
      --secondary:#50b8e7;
      --accent:#f5a623;
      --bg:#f4f7fb;
      --card:#ffffff;
      --text:#12202b;
      --muted:#6b7280;
      --radius:12px;
      --shadow: 0 8px 28px rgba(16,24,40,0.08);
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:var(--text);background:var(--bg);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
    a{color:var(--primary);text-decoration:none}
    img{max-width:100%;display:block}

    /* Header */
    header{
      background: linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;
      text-align:center;
      padding:clamp(36px,6vw,72px) 20px;
      position:relative;
      overflow:hidden;
    }
    header h1{font-size:clamp(1.6rem,3.6vw,2.6rem);margin:0 0 6px}
    header p{margin:0;font-size:clamp(0.95rem,1.8vw,1.1rem);opacity:.95}

    /* header decorative bottom */
    header::after{
      content:"";
      position:absolute;left:0;right:0;bottom:-50px;height:100px;background:#fff;
      clip-path:ellipse(75% 100% at 50% 100%);
      pointer-events:none;
    }

    /* Top controls (flags & translate) */
    .top-controls{
      position:absolute;top:14px;right:14px;display:flex;gap:8px;align-items:center;z-index:40;
    }
    .flag-btn{
      display:inline-grid;
      grid-auto-flow:column;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      background:#fff;border-radius:10px;border:none;cursor:pointer;font-weight:700;color:var(--primary);
      box-shadow:0 4px 12px rgba(16,24,40,0.06);
    }
    .flag-btn[aria-pressed="true"]{box-shadow:0 6px 18px rgba(46,111,183,0.18);transform:translateY(-2px)}
    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;border:0;padding:0;margin:-1px;}

    /* Navigation */
    nav{background:#fff;display:flex;justify-content:center;gap:28px;padding:12px 20px;box-shadow:0 4px 10px rgba(16,24,40,0.06);position:sticky;top:0;z-index:30}
    nav a, nav button{font-weight:700;color:var(--primary);background:none;border:none;cursor:pointer;padding:6px 4px;position:relative;font-size:.98rem}
    nav a::after, nav button::after{content:"";position:absolute;left:0;bottom:0;height:3px;width:0;background:var(--accent);transition:width .22s}
    nav a:hover::after, nav button:hover::after{width:100%}

    /* Main content */
    main{max-width:1100px;margin:40px auto;padding:0 20px}
    section h2{text-align:center;color:var(--primary);margin-bottom:18px;font-size:clamp(1.4rem,2.5vw,1.9rem);position:relative}
    section h2::after{content:"";display:block;width:64px;height:4px;background:var(--accent);margin:10px auto 0;border-radius:2px}

    .card-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:22px}
    .teacher-card{background:var(--card);border-radius:var(--radius);padding:20px;text-align:center;box-shadow:var(--shadow);display:flex;flex-direction:column;align-items:center;gap:10px;transition:transform .22s,box-shadow .22s;cursor:pointer}
    .teacher-card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(16,24,40,0.12)}
    .teacher-card img{width:110px;height:110px;border-radius:50%;object-fit:cover;border:3px solid var(--secondary);background:#eee;flex-shrink:0}
    .teacher-card h3{margin-top:8px;font-size:1.05rem;color:#111827}
    .teacher-card p{color:var(--muted);margin-bottom:6px;font-size:.95rem}
    .teacher-card .view-link{margin-top:auto;display:inline-block;background:var(--primary);color:#fff;padding:8px 16px;border-radius:10px;font-weight:700;transition:background .18s,transform .12s}
    .teacher-card .view-link:hover{background:var(--secondary);transform:translateY(-2px)}

    /* Footer */
    footer{background:#fff;text-align:center;padding:20px;margin-top:40px;box-shadow:0 -2px 8px rgba(0,0,0,0.03);font-size:.95rem;color:var(--muted)}

    /* Modals */
    .modal{position:fixed;inset:0;background:rgba(2,6,23,0.55);display:none;align-items:center;justify-content:center;padding:24px;z-index:100}
    .modal[aria-hidden="false"]{display:flex}
    .modal-content{background:var(--card);padding:28px;border-radius:14px;max-width:920px;width:100%;position:relative;box-shadow:0 10px 30px rgba(2,6,23,0.18);max-height:90vh;overflow:auto;animation:modalIn .32s ease}
    @keyframes modalIn{from{transform:translateY(18px);opacity:0}to{transform:none;opacity:1}}
    .modal-close{position:absolute;right:18px;top:16px;background:transparent;border:2px solid #eee;border-radius:8px;padding:6px 8px;cursor:pointer;font-weight:700}
    .modal-top{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px}
    .about-visual{display:flex;gap:18px;align-items:center}
    .about-visual .hero{width:120px;height:120px;border-radius:12px;background:linear-gradient(135deg,var(--secondary),var(--primary));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1.05rem;box-shadow:0 8px 20px rgba(46,111,183,0.12)}
    .about-text p{margin:8px 0;color:var(--muted);line-height:1.5}
    .profile-header{display:flex;align-items:center;gap:20px;border-bottom:1px solid #eee;padding-bottom:20px;margin-bottom:18px}
    .profile-header img{width:160px;height:160px;object-fit:cover;border-radius:12px}
    .profile-meta p{margin:6px 0;color:var(--muted)}
    .buttons{display:flex;gap:10px;margin-top:18px;flex-wrap:wrap}
    .btn{padding:10px 16px;border-radius:10px;font-weight:700;text-decoration:none;display:inline-block}
    .btn.green{background:#2ecc71;color:#fff}
    .btn.blue{background:#3498db;color:#fff}
    .btn.grey{background:#bdc3c7;color:#222}

    /* small screens */
    @media(max-width:720px){
      .profile-header{flex-direction:column;align-items:flex-start}
      .profile-header img{width:120px;height:120px}
      .about-visual{flex-direction:column;align-items:flex-start}
      header{padding:44px 16px}
    }
  </style>
</head>
<body>
  <!-- Top header -->
  <header>
    <div class="top-controls" aria-hidden="false">
      <!-- flag buttons -->
      <button class="flag-btn" id="btnEN" aria-label="English" title="English" data-lang="en" aria-pressed="false">
        <!-- SVG flag - UK (stylized) -->
        <svg width="18" height="12" viewBox="0 0 60 36" aria-hidden="true"><rect width="60" height="36" fill="#012169"/><path d="M0 0 L60 36 M60 0 L0 36" stroke="#fff" stroke-width="6"/><path d="M0 0 L60 36 M60 0 L0 36" stroke="#C8102E" stroke-width="3"/></svg>
        EN
      </button>

      <button class="flag-btn" id="btnRU" aria-label="Русский" title="Русский" data-lang="ru" aria-pressed="false">
        <!-- Russia flag -->
        <svg width="18" height="12" viewBox="0 0 6 4" aria-hidden="true"><rect width="6" height="4" fill="#fff"/><rect y="1.333" width="6" height="1.333" fill="#0039A6"/><rect y="2.666" width="6" height="1.333" fill="#D52B1E"/></svg>
        RU
      </button>

      <button class="flag-btn" id="btnKZ" aria-label="Қазақша" title="Қазақша" data-lang="kz" aria-pressed="false">
        <!-- Kazakhstan (stylized) -->
        <svg width="18" height="12" viewBox="0 0 6 4" aria-hidden="true"><rect width="6" height="4" fill="#00A3E0"/><circle cx="1.5" cy="2" r="0.6" fill="#F2B705"/></svg>
        KZ
      </button>
    </div>

    <h1 id="siteTitle">MyTutor.Kz</h1>
    <p id="siteTagline">Online learning for kids</p>
  </header>

  <!-- Navigation -->
  <nav role="navigation" aria-label="Main navigation">
    <button id="openAbout" aria-controls="aboutModal" aria-haspopup="dialog">About Us</button>
    <a href="#teachers" id="navTutors">Tutors</a>
    <a href="#contacts" id="navContacts">Contacts</a>
  </nav>

  <!-- Main -->
  <main>
    <!-- Tutors -->
    <section id="teachers" aria-labelledby="tutorsTitle">
      <h2 id="tutorsTitle">Popular Tutors</h2>
      <div class="card-container" role="list">
        <article class="teacher-card" role="listitem" tabindex="0" aria-label="Fazyl Sandzhar — open profile" id="sandzhar-card" data-teacher="sandzhar">
          <img loading="lazy" src="SANDZHAR.jpg" alt="Fazyl Sandzhar — English Tutor" id="sandzharThumb" width="110" height="110" />
          <h3 id="sandzharName">F.Sandzhar</h3>
          <p id="sandzharMeta">⭐ 4.9 | 3 years experience</p>
          <span class="view-link" role="link" aria-hidden="true">View Profile</span>
        </article>

        <!-- other example tutors -->
        <article class="teacher-card" role="listitem">
          <img loading="lazy" src="https://randomuser.me/api/portraits/men/32.jpg" alt="Nursultan — English Tutor" />
          <h3>N.Zhasulan</h3>
          <p>⭐ 4.8 | 2 years experience</p>
          <a class="view-link" href="#">View Profile</a>
        </article>

        <article class="teacher-card" role="listitem">
          <img loading="lazy" src="https://randomuser.me/api/portraits/women/65.jpg" alt="Aliya K. — English Tutor" />
          <h3>KOTAK</h3>
          <p>⭐ 4.7 | 4 years experience</p>
          <a class="view-link" href="#">View Profile</a>
        </article>
      </div>
    </section>

    <!-- Contacts -->
    <section id="contacts" aria-labelledby="contactsTitle" style="margin-top:30px;">
      <h2 id="contactsTitle">Contacts</h2>
      <p style="text-align:center;color:var(--muted)">Email: <a href="mailto:info@mytutor.kz">info@mytutor.kz</a></p>
      <p style="text-align:center;color:var(--muted)">Numbers: <a href="mailto:+7 705 256 4760">+7 705 256 4760</a></p>
      <p style="text-align:center;color:var(--muted)"> <a href="mailto:+7 705 256 4760">+7 705 256 4760</a></p>
    </section>
  </main>

  <footer>
    <p>&copy; <span id="year"></span> MyTutor.Kz. All rights reserved.</p>
  </footer>

  <!-- About modal (card-style) -->
  <div class="modal" id="aboutModal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="aboutTitle">
    <div class="modal-content" role="document">
      <button class="modal-close" id="closeAbout" aria-label="Close">&times;</button>
      <div class="modal-top">
        <div style="display:flex;align-items:center;gap:12px">
          <div class="about-visual">
            <div class="hero" aria-hidden="true">MyTutor</div>
            <div class="about-text">
              <h2 id="aboutTitle">About Us</h2>
              <p id="aboutIntro" style="margin:6px 0;color:var(--muted)"></p>
            </div>
          </div>
        </div>
        <div style="text-align:right">
          <small style="color:var(--muted)">Language:</small>
          <div style="display:inline-block;margin-left:8px">
            <button class="flag-btn" id="aboutEN" data-lang="en" aria-pressed="false" style="padding:6px 8px;font-weight:600">EN</button>
            <button class="flag-btn" id="aboutRU" data-lang="ru" aria-pressed="false" style="padding:6px 8px;font-weight:600">RU</button>
            <button class="flag-btn" id="aboutKZ" data-lang="kz" aria-pressed="false" style="padding:6px 8px;font-weight:600">KZ</button>
          </div>
        </div>
      </div>

      <div id="aboutBody" style="margin-top:10px;color:var(--muted);line-height:1.5"></div>

      <div style="margin-top:16px;text-align:center">
        <a href="#" class="btn green" id="aboutCTA">Get Started</a>
      </div>
    </div>
  </div>

  <!-- Profile modal (Fazyl Sandzhar) -->
  <div class="modal" id="profileModal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="profileTitle">
    <div class="modal-content" role="document">
      <button class="modal-close" id="closeProfile" aria-label="Close">&times;</button>

      <div class="profile-header">
        <img loading="lazy" src="SANDZHAR.jpg" alt="Фазыл Санджар — фото" id="profilePhoto" />
        <div class="profile-meta">
          <h1 id="profileName">Фазыл Санджар</h1>
          <p id="profileCity"><strong>Город:</strong> Астана, Казахстан</p>
          <p id="profileEdu"><strong>Образование:</strong> Студент 1 курса Astana IT University</p>
          <p id="profileLev"><strong>Уровень:</strong>C1, Advanced</p>
          <p id="profileExp"><strong>Опыт преподавания:</strong> 1 год</p>
          <p id="profilePrice"><strong>Стоимость:</strong> 2,500 ₸ / 60 мин</p>
          <p id="profileLevel"><strong>Обучает уровни:</strong> Beginners – Uppper-Intermediate</p>
        </div>
      </div>

      <h2 id="formatTitle">Формат занятий</h2>
      <p id="formatText">Онлайн-занятия: Zoom / Google Meet</p>
      <p id="durationText">Длительность: 45–60 минут</p>
      <p id="scheduleText">График: гибкий (вечерние занятия)</p>

      <h2 id="materialsTitle">Учебные материалы</h2>
      <p id="materialsText">Oxford, Cambridge, собственные презентации</p>

      <h2 id="languagesTitle">Языки преподавания</h2>
      <p id="languagesText">Английский / Русский</p>

      <h2 id="directionsTitle">Направления обучения</h2>
      <p id="directionsText">Грамматика, разговорная практика, понимание на слух</p>

      <div class="buttons">
        <a href="#" class="btn green" id="bookBtn">Записаться на урок</a>
        <a href="#" class="btn blue" id="messageBtn">Написать преподавателю</a>
        <a href="#" class="btn grey" id="closeProfileBtn">Назад</a>
      </div>
    </div>
  </div>

  <script>
    /* ===== TRANSLATIONS ===== */
    const translations = {
      en: {
        siteTitle: "MyTutor.Kz",
        siteTagline: "Online learning for kids",
        tutorsTitle: "Popular Tutors",
        contactsTitle: "Contacts",
        aboutTitle: "About Us",
        aboutIntro: "Personalized online English lessons for children — experienced tutors, flexible schedule, and affordable prices.",
        aboutBody: `<p>We are a team of university students passionate about teaching English to children. Our tutors have strong experience with young learners and hold internationally recognized certificates (IELTS 7.0–8.0).</p>
                    <p>Our platform focuses on making learning engaging, effective and affordable. We design personalized plans to boost speaking, grammar and confidence.</p>`,
        aboutCTA: "Get Started",
        profile: {
          name: "Fazyl Sandzhar",
          city: "Astana, Kazakhstan",
          edu: "1st year student — Astana IT University",
          exp: "1 year",
          price: "2,500 ₸ / 60 min",
          levels: "Beginners – Upper-Intermediate",
          formatTitle: "Lesson format",
          formatText: "Online lessons: Zoom / Google Meet",
          duration: "Duration: 45–60 minutes",
          schedule: "Schedule: flexible (morning & evening classes)",
          materialsTitle: "Materials",
          materials: "Oxford, Cambridge, custom presentations",
          languagesTitle: "Teaching languages",
          languages: "English / Kazakh / Russian",
          directionsTitle: "Focus areas",
          directions: "Grammar, conversational speaking, listening comprehension",
          book: "Book a lesson",
          message: "Message the tutor",
          back: "Back to list"
        }
      },
      ru: {
        siteTitle: "MyTutor.Kz",
        siteTagline: "Онлайн-обучение для детей",
        tutorsTitle: "Популярные репетиторы",
        contactsTitle: "Контакты",
        aboutTitle: "О нас",
        aboutIntro: "Персональные онлайн-уроки английского для детей — опытные преподаватели, гибкий график и доступные цены.",
        aboutBody: `<p>Мы — команда студентов, увлечённых преподаванием английского детям. Наши преподаватели имеют опыт работы с молодыми учениками и подтверждённые международные сертификаты (IELTS 7.0–8.0).</p>
                    <p>Наша цель — сделать обучение интересным, эффективным и доступным. Мы разрабатываем персональные планы для развития разговорной речи, грамматики и уверенности.</p>`,
        aboutCTA: "Начать",
        profile: {
          name: "Фазыл Санджар",
          city: "Астана, Казахстан",
          edu: "Студент 1 курса — Astana IT University",
          exp: "1 год",
          price: "2,500 ₸ / 60 мин",
          levels: "Beginners – Upper-Intermediate",
          formatTitle: "Формат занятий",
          formatText: "Онлайн-занятия: Zoom / Google Meet",
          duration: "Длительность: 45–60 минут",
          schedule: "График: гибкий (вечерние занятия)",
          materialsTitle: "Учебные материалы",
          materials: "Oxford, Cambridge, собственные презентации",
          languagesTitle: "Языки преподавания",
          languages: "Английский / Казахский / Русский",
          directionsTitle: "Направления обучения",
          directions: "Грамматика, разговорная практика, понимание на слух",
          book: "Записаться на урок",
          message: "Написать преподавателю",
          back: "Назад к списку"
        }
      },
      kz: {
        siteTitle: "MyTutor.Kz",
        siteTagline: "Балаларға арналған онлайн-оқыту",
        tutorsTitle: "Танымал репетиторлар",
        contactsTitle: "Байланыс",
        aboutTitle: "Біз туралы",
        aboutIntro: "Балаларға арналған жеке онлайн ағылшын сабақтары — тәжірибелі мұғалімдер, икемді кесте және қолжетімді бағалар.",
        aboutBody: `<p>Біз — балаларға ағылшын тілін үйретуге құмар университет студенттері. Біздің мұғалімдер жас оқушылармен жұмыс тәжірибесіне және халықаралық сертификаттарға ие (IELTS 7.0–8.0).</p>
                    <p>Біздің мақсат — оқытуды қызықты, тиімді және қолжетімді ету. Біз сөйлесу, грамматика және сенімділікке бағытталған жеке бағдарламалар ұсынамыз.</p>`,
        aboutCTA: "Бастау",
        profile: {
          name: "Фазыл Санджар",
          city: "Астана, Қазақстан",
          edu: "1-курс студенті — Astana IT University",
          exp: "1 жыл",
          price: "2,500 ₸ / 60 мин",
          levels: "Beginners – Upper-Intermediate",
          formatTitle: "Сабақ форматы",
          formatText: "Онлайн сабақтар: Zoom / Google Meet",
          duration: "Ұзақтығы: 45–60 минут",
          schedule: "График: икемді (таңғы және кешкі сабақтар)",
          materialsTitle: "Оқу материалдары",
          materials: "Oxford, Cambridge, жеке презентациялар",
          languagesTitle: "Оқытатын тілдер",
          languages: "Ағылшын / Қазақ / Орыс",
          directionsTitle: "Оқыту бағыттары",
          directions: "Грамматика, сөйлесу тәжірибесі, тыңдауды түсіну",
          book: "Сабаққа жазылу",
          message: "Ұстазға хабар жазу",
          back: "Тізімге оралу"
        }
      }
    };

    /* ===== DOM elements ===== */
    const btnEN = document.getElementById('btnEN');
    const btnRU = document.getElementById('btnRU');
    const btnKZ = document.getElementById('btnKZ');
    const aboutEN = document.getElementById('aboutEN');
    const aboutRU = document.getElementById('aboutRU');
    const aboutKZ = document.getElementById('aboutKZ');

    const siteTitleEl = document.getElementById('siteTitle');
    const siteTaglineEl = document.getElementById('siteTagline');
    const tutorsTitleEl = document.getElementById('tutorsTitle');
    const contactsTitleEl = document.getElementById('contactsTitle');
    const aboutTitleEl = document.getElementById('aboutTitle');
    const aboutIntroEl = document.getElementById('aboutIntro');
    const aboutBodyEl = document.getElementById('aboutBody');
    const aboutCTA = document.getElementById('aboutCTA');

    const profileModal = document.getElementById('profileModal');
    const aboutModal = document.getElementById('aboutModal');

    const profileName = document.getElementById('profileName');
    const profileCity = document.getElementById('profileCity');
    const profileEdu = document.getElementById('profileEdu');
    const profileExp = document.getElementById('profileExp');
    const profilePrice = document.getElementById('profilePrice');
    const profileLevel = document.getElementById('profileLevel');

    const formatTitle = document.getElementById('formatTitle');
    const formatText = document.getElementById('formatText');
    const durationText = document.getElementById('durationText');
    const scheduleText = document.getElementById('scheduleText');

    const materialsTitle = document.getElementById('materialsTitle');
    const materialsText = document.getElementById('materialsText');

    const languagesTitle = document.getElementById('languagesTitle');
    const languagesText = document.getElementById('languagesText');

    const directionsTitle = document.getElementById('directionsTitle');
    const directionsText = document.getElementById('directionsText');

    const bookBtn = document.getElementById('bookBtn');
    const messageBtn = document.getElementById('messageBtn');
    const closeProfileBtn = document.getElementById('closeProfileBtn');

    const sandzharCard = document.getElementById('sandzhar-card');

    /* ===== Local storage language handling ===== */
    let currentLang = localStorage.getItem('mt_lang') || 'en';

    function setActiveFlagButtons(lang){
      // header flags
      [btnEN, btnRU, btnKZ].forEach(b => b.setAttribute('aria-pressed','false'));
      if(lang === 'en') btnEN.setAttribute('aria-pressed','true');
      if(lang === 'ru') btnRU.setAttribute('aria-pressed','true');
      if(lang === 'kz') btnKZ.setAttribute('aria-pressed','true');
      // about small flags
      [aboutEN, aboutRU, aboutKZ].forEach(b => b.setAttribute('aria-pressed','false'));
      if(lang === 'en') aboutEN.setAttribute('aria-pressed','true');
      if(lang === 'ru') aboutRU.setAttribute('aria-pressed','true');
      if(lang === 'kz') aboutKZ.setAttribute('aria-pressed','true');
    }

    function applyLanguage(lang){
      const t = translations[lang] || translations.en;
      document.documentElement.lang = (lang === 'kz') ? 'kk' : lang;
      siteTitleEl.textContent = t.siteTitle;
      siteTaglineEl.textContent = t.siteTagline;
      tutorsTitleEl.textContent = t.tutorsTitle;
      contactsTitleEl.textContent = t.contactsTitle;
      aboutTitleEl.textContent = t.aboutTitle;
      aboutIntroEl.textContent = t.aboutIntro;
      aboutBodyEl.innerHTML = t.aboutBody;
      aboutCTA.textContent = t.aboutCTA;

      // profile
      profileName.textContent = t.profile.name;
      profileCity.innerHTML = `<strong>Город:</strong> ${t.profile.city}`;
      profileEdu.innerHTML = `<strong>Образование:</strong> ${t.profile.edu}`;
      profileExp.innerHTML = `<strong>Опыт преподавания:</strong> ${t.profile.exp}`;
      profilePrice.innerHTML = `<strong>Стоимость:</strong> ${t.profile.price}`;
      profileLevel.innerHTML = `<strong>Обучает уровни:</strong> ${t.profile.levels}`;

      formatTitle.textContent = t.profile.formatTitle;
      formatText.textContent = t.profile.formatText;
      durationText.textContent = t.profile.duration;
      scheduleText.textContent = t.profile.schedule;

      materialsTitle.textContent = t.profile.materialsTitle;
      materialsText.textContent = t.profile.materials;

      languagesTitle.textContent = t.profile.languagesTitle;
      languagesText.textContent = t.profile.languages;

      directionsTitle.textContent = t.profile.directionsTitle;
      directionsText.textContent = t.profile.directions;

      bookBtn.textContent = t.profile.book;
      messageBtn.textContent = t.profile.message;
      closeProfileBtn.textContent = t.profile.back;

      // update card name if needed
      document.getElementById('sandzharName').textContent = (lang === 'ru' || lang === 'kz') ? 'Ф.Санджар' : 'F.Sandzhar';

      setActiveFlagButtons(lang);
      localStorage.setItem('mt_lang', lang);
      currentLang = lang;
    }

    // initialize
    applyLanguage(currentLang);

    // flag click handlers
    [btnEN, btnRU, btnKZ].forEach(btn => {
      btn.addEventListener('click', () => applyLanguage(btn.dataset.lang));
    });
    [aboutEN, aboutRU, aboutKZ].forEach(btn => {
      btn.addEventListener('click', () => applyLanguage(btn.dataset.lang));
    });

    /* ===== Modal helpers: focus trap & keyboard ===== */
    function trapFocus(modal){
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if(focusable.length === 0) return null;
      const first = focusable[0];
      const last = focusable[focusable.length - 1];
      function handleKey(e){
        if(e.key === 'Escape'){ closeModal(modal); }
        if(e.key === 'Tab'){
          if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
          else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
        }
      }
      modal.addEventListener('keydown', handleKey);
      return () => modal.removeEventListener('keydown', handleKey);
    }

    function openModal(modal){
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      // save last focused
      modal._lastFocused = document.activeElement;
      // focus first interactive element
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if(focusable.length) focusable[0].focus();
      modal._removeKeyTrap = trapFocus(modal);
      // close on outside click
      modal.addEventListener('click', modal._outsideClick = function(e){
        if(e.target === modal){ closeModal(modal); }
      });
    }

    function closeModal(modal){
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
      if(modal._removeKeyTrap) modal._removeKeyTrap();
      if(modal._outsideClick) modal.removeEventListener('click', modal._outsideClick);
      // return focus
      if(modal._lastFocused) modal._lastFocused.focus();
    }

    // About modal toggle
    const openAboutBtn = document.getElementById('openAbout');
    const closeAboutBtn = document.getElementById('closeAbout');
    openAboutBtn.addEventListener('click', () => {
      applyLanguage(currentLang); // ensure content up to date
      openModal(aboutModal);
    });
    closeAboutBtn.addEventListener('click', () => closeModal(aboutModal));

    // Profile modal: open when clicking card
    sandzharCard.addEventListener('click', () => {
      applyLanguage(currentLang); // ensure profile text set correctly
      openModal(profileModal);
    });
    // keyboard support: Enter or Space when card focused
    sandzharCard.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); sandzharCard.click(); }
    });

    // profile modal close buttons
    document.getElementById('closeProfile').addEventListener('click', () => closeModal(profileModal));
    closeProfileBtn.addEventListener('click', () => closeModal(profileModal));

    // universal ESC handler (extra safety)
    document.addEventListener('keydown', (e) => {
      if(e.key === 'Escape'){
        if(aboutModal.getAttribute('aria-hidden') === 'false') closeModal(aboutModal);
        if(profileModal.getAttribute('aria-hidden') === 'false') closeModal(profileModal);
      }
    });

    // set year
    document.getElementById('year').textContent = new Date().getFullYear();

    // image error fallback
    document.querySelectorAll('img').forEach(img => {
      img.addEventListener('error', () => {
        img.src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><rect width="100%" height="100%" fill="#eee"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#999" font-family="Arial" font-size="14">No image</text></svg>');
      });
    });

    // small keyboard shortcut: ? opens About
    document.addEventListener('keydown', (e) => {
      if(e.key === '?'){ e.preventDefault(); openModal(aboutModal); }
    });

    // ensure accessible focus outlines only for keyboard users
    (function initFocusStyle(){
      function handleMouse(){ document.body.classList.add('using-mouse'); }
      function handleKey(e){ if(e.key === 'Tab') document.body.classList.remove('using-mouse'); }
      document.addEventListener('mousedown', handleMouse);
      document.addEventListener('keydown', handleKey);
    })();
  </script>
</body>
</html>

